(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{V6eh:function(e,o,t){"use strict";t.r(o),t.d(o,"CouponModule",(function(){return H}));var r=t("ofXK"),c=t("tyNb"),n=t("fXoL"),u=t("z6cu"),i=t("tk/3"),s=t("vkgz"),a=t("lJxs"),l=t("JIr8"),b=t("R5w1");let d=(()=>{class e{constructor(e){this.http=e,this.couponServiceUrl="https://api.grostep.com/vouchersapi/"}fetchAllCoupons(e,o,t){const r={};return r.page_number=e,r.page_size=o,r.filterBy=t,console.log(r),this.http.post(this.couponServiceUrl+"couponinfo",r).pipe(Object(s.a)(e=>{}),Object(a.a)(e=>e),Object(l.a)(this.handleError))}deleteCoupon(e){const o=new i.c({"Content-Type":"application/json"});return this.http.delete(`${this.couponServiceUrl}couponinfo/${e}`,{headers:o}).pipe(Object(s.a)(e=>{}),Object(l.a)(this.handleError))}addNewCoupon(e){const o={};o.voucherCode=e.voucherCode,o.voucherAmount=e.voucherAmount,o.expirydatetime=e.expirydatetime,o.voucherCartAmount=e.voucherCartAmount,o.voucherType=e.voucherType,o.description=e.description,o.status=+e.status;const t=this.couponServiceUrl+"addnewcoupon",r=new i.c({"Content-Type":"application/json"});return this.http.post(t,o,{headers:r}).pipe(Object(s.a)(e=>{}),Object(a.a)(e=>e),Object(l.a)(e=>this.handleError(e)))}editCoupon(e,o){const t={};t.voucher_code=e.voucherCode,t.voucher_amount=e.voucherAmount,t.expiry_datetime=e.expirydatetime,t.voucher_cart_amount=e.voucherCartAmount,t.voucher_type=e.voucherType,t.description=e.description,t.status=+e.status;const r=`${this.couponServiceUrl}couponinfo/${o}`;console.log(r);const c=new i.c({"Content-Type":"application/json"});return this.http.put(r,t,{headers:c}).pipe(Object(s.a)(e=>{}),Object(a.a)(e=>e),Object(l.a)(this.handleError))}fetchCouponDetails(e){return this.http.get(`${this.couponServiceUrl}couponinfo/${e}`).pipe(Object(s.a)(e=>{}),Object(a.a)(e=>e),Object(l.a)(this.handleError))}handleError(e){const o=new b.a;return o.errorNumber=100,o.errorMessage=`Server returned code: ${e.status}, error message is: ${e.message}`,o.friendlyMessage="An error retriving data",Object(u.a)(o)}}return e.\u0275fac=function(o){return new(o||e)(n.Zb(i.a))},e.\u0275prov=n.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var h=t("chph"),p=t("1kSV");const v=["app-coupon-data",""];function f(e,o){if(1&e&&n.Nb(0,"img",8),2&e){const e=n.fc();n.zc("width",e.imageWidth,"px")("height",e.imageHeight,"px")("margin",e.imageMargin,"px")}}function m(e,o){if(1&e){const e=n.Sb();n.Rb(0,"span",9),n.dc("click",(function(){n.uc(e);const o=n.fc();return o.uploadImage(o.voucher.voucher_id)})),n.Cc(1," Upload Image "),n.Qb()}}function g(e,o){if(1&e&&n.Nb(0,"img",10),2&e){const e=n.fc();n.zc("height",e.imageHeight,"px")("width",e.imageWidth,"px")("margin",e.imageMargin,"px"),n.mc("src",null==e.voucher?null:e.voucher.image_url,n.vc),n.lc("title",null==e.voucher?null:e.voucher.voucher_code)}}function C(e,o){if(1&e){const e=n.Sb();n.Rb(0,"span",9),n.dc("click",(function(){n.uc(e);const o=n.fc();return o.uploadImage(o.voucher.voucher_id)})),n.Cc(1," Change Image "),n.Qb()}}const R=function(e){return["/coupon",e]},Q=function(e){return["/coupon",e,"edit"]};let y=(()=>{class e{constructor(e,o){this.modalService=e,this.couponService=o,this.imageWidth=80,this.imageHeight=80,this.imageMargin=2}ngOnInit(){}uploadImage(e){console.log(e);const o=this.modalService.open(h.a);o.componentInstance.title="Image Upload",o.componentInstance.id=e,o.componentInstance.image_type="banners"}deleteCoupons(e){confirm("Are you sure to delete")&&this.couponService.deleteCoupon(e).subscribe(e=>{console.log(e)})}}return e.\u0275fac=function(o){return new(o||e)(n.Mb(p.b),n.Mb(d))},e.\u0275cmp=n.Gb({type:e,selectors:[["","app-coupon-data",""]],inputs:{voucher:["voucherInfo","voucher"]},attrs:v,decls:26,vars:20,consts:[["src","assets/product_images/default_image.jpg",3,"width","height","margin",4,"ngIf"],["style","display:block;font-size:14px;cursor:pointer;color:blue",3,"click",4,"ngIf"],[3,"src","title","height","width","margin",4,"ngIf"],["style","display:block;font-size:14px;\n              cursor:pointer;color:blue",3,"click",4,"ngIf"],[3,"routerLink"],[2,"font-weight","bold"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"btn","btn-outline-secondary",2,"margin-left","5px",3,"click"],["src","assets/product_images/default_image.jpg"],[2,"display","block","font-size","14px","cursor","pointer","color","blue",3,"click"],[3,"src","title"]],template:function(e,o){1&e&&(n.Rb(0,"td"),n.Ac(1,f,1,6,"img",0),n.Ac(2,m,2,0,"span",1),n.Ac(3,g,1,8,"img",2),n.Ac(4,C,2,0,"span",3),n.Qb(),n.Rb(5,"td"),n.Rb(6,"a",4),n.Cc(7),n.Qb(),n.Qb(),n.Rb(8,"td"),n.Rb(9,"a",4),n.Cc(10),n.Qb(),n.Qb(),n.Rb(11,"td"),n.Cc(12),n.Qb(),n.Rb(13,"td"),n.Cc(14),n.Qb(),n.Rb(15,"td"),n.Cc(16),n.Qb(),n.Rb(17,"td"),n.Cc(18),n.Qb(),n.Rb(19,"td",5),n.Cc(20),n.Qb(),n.Rb(21,"td"),n.Rb(22,"button",6),n.Cc(23,"Edit"),n.Qb(),n.Rb(24,"button",7),n.dc("click",(function(){return o.deleteCoupons(null==o.voucher?null:o.voucher.voucher_id)})),n.Cc(25," Delete "),n.Qb(),n.Qb()),2&e&&(n.zb(1),n.lc("ngIf",!(null!=o.voucher&&o.voucher.image_url)),n.zb(1),n.lc("ngIf",!(null!=o.voucher&&o.voucher.image_url)),n.zb(1),n.lc("ngIf",null==o.voucher?null:o.voucher.image_url),n.zb(1),n.lc("ngIf",null==o.voucher?null:o.voucher.image_url),n.zb(2),n.lc("routerLink",n.pc(14,R,o.voucher.voucher_id)),n.zb(1),n.Ec(" ",null==o.voucher?null:o.voucher.voucher_id," "),n.zb(2),n.lc("routerLink",n.pc(16,R,o.voucher.voucher_id)),n.zb(1),n.Ec(" ",null==o.voucher?null:o.voucher.voucher_code," "),n.zb(2),n.Ec(" ",null==o.voucher?null:o.voucher.voucher_amount,"\n"),n.zb(2),n.Ec(" ",null==o.voucher?null:o.voucher.expiry_datetime,"\n"),n.zb(2),n.Ec(" ",null==o.voucher?null:o.voucher.voucher_cart_amount,"\n"),n.zb(2),n.Ec(" ",null==o.voucher?null:o.voucher.voucher_type,"\n"),n.zb(2),n.Dc(null!=o.voucher&&o.voucher.status?"Available":"Not Available"),n.zb(2),n.lc("routerLink",n.pc(18,Q,null==o.voucher?null:o.voucher.voucher_id)))},directives:[r.m,c.i,c.g],styles:[""]}),e})();var I=t("Exvd");function A(e,o){1&e&&n.Nb(0,"tr",16),2&e&&n.lc("voucherInfo",o.$implicit)}function z(e,o){if(1&e&&(n.Rb(0,"table",13),n.Rb(1,"thead"),n.Rb(2,"tr"),n.Nb(3,"th"),n.Rb(4,"th",14),n.Cc(5,"Voucher Id"),n.Qb(),n.Rb(6,"th",14),n.Cc(7,"Voucher Code"),n.Qb(),n.Rb(8,"th",14),n.Cc(9,"Voucher Amount"),n.Qb(),n.Rb(10,"th"),n.Cc(11,"Expiry Time"),n.Qb(),n.Rb(12,"th"),n.Cc(13,"Voucher Cart Amount"),n.Qb(),n.Rb(14,"th"),n.Cc(15,"Voucher Type"),n.Qb(),n.Rb(16,"th"),n.Cc(17,"Status"),n.Qb(),n.Nb(18,"th"),n.Qb(),n.Qb(),n.Rb(19,"tbody"),n.Ac(20,A,1,1,"tr",15),n.Qb(),n.Qb()),2&e){const e=n.fc();n.zb(20),n.lc("ngForOf",e.vouchers)}}function _(e,o){if(1&e){const e=n.Sb();n.Rb(0,"app-pagination",17),n.dc("currentPage",(function(o){return n.uc(e),n.fc().currentPageFn(o)})),n.Qb()}if(2&e){const e=n.fc();n.lc("totalItemCount",e.voucherTotalCount)}}function x(e,o){1&e&&(n.Rb(0,"div"),n.Cc(1," No Vouchers Data Found "),n.Qb())}function w(e,o){if(1&e&&(n.Rb(0,"div",18),n.Cc(1),n.Qb()),2&e){const e=n.fc();n.zb(1),n.Ec(" Error: ",e.errorMessage,"\n")}}const S=function(){return["/coupon/",0,"edit"]};let N=(()=>{class e{constructor(e){this.couponservice=e,this.currentPage=1,this.pageSize=20,this.filterBy="",this.pageTitle="Coupon Management",this.vouchers=[]}ngOnInit(){this.couponservice.fetchAllCoupons(this.currentPage,this.pageSize,"").subscribe(e=>{console.log(e),this.vouchers=e.vouchers,this.voucherTotalCount=e.voucher_total_count.vouchers_count},e=>{this.errorMessage=e})}currentPageFn(e){this.couponservice.fetchAllCoupons(e,this.pageSize,this.filterBy).subscribe(e=>{this.vouchers=e.vouchers,this.voucherTotalCount=e.voucher_total_count.vouchers_count},e=>{this.errorMessage=e})}}return e.\u0275fac=function(o){return new(o||e)(n.Mb(d))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-coupon-dashboard"]],decls:16,vars:7,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-md-2"],[1,"col-md-4"],[1,"col-md-6"],[1,"btn","btn-outline-secondary",2,"float","right",3,"routerLink"],[1,"table-responsive"],["style","width:1200px !important","class","table",4,"ngIf"],[3,"totalItemCount","currentPage",4,"ngIf"],[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"table",2,"width","1200px !important"],[2,"width","90px !important"],["app-coupon-data","",3,"voucherInfo",4,"ngFor","ngForOf"],["app-coupon-data","",3,"voucherInfo"],[3,"totalItemCount","currentPage"],[1,"alert","alert-danger"]],template:function(e,o){1&e&&(n.Rb(0,"div",0),n.Rb(1,"div",1),n.Cc(2),n.Qb(),n.Rb(3,"div",2),n.Rb(4,"div",3),n.Rb(5,"div",4),n.Cc(6,"Filter by:"),n.Qb(),n.Nb(7,"div",5),n.Rb(8,"div",6),n.Rb(9,"button",7),n.Cc(10," Add New Coupon "),n.Qb(),n.Qb(),n.Qb(),n.Rb(11,"div",8),n.Ac(12,z,21,1,"table",9),n.Ac(13,_,1,1,"app-pagination",10),n.Ac(14,x,2,0,"div",11),n.Qb(),n.Qb(),n.Qb(),n.Ac(15,w,2,1,"div",12)),2&e&&(n.zb(2),n.Ec(" ",o.pageTitle," "),n.zb(7),n.lc("routerLink",n.oc(6,S)),n.zb(3),n.lc("ngIf",null==o.vouchers?null:o.vouchers.length),n.zb(1),n.lc("ngIf",o.vouchers.length),n.zb(1),n.lc("ngIf",0==(null==o.vouchers?null:o.vouchers.length)),n.zb(1),n.lc("ngIf",o.errorMessage))},directives:[c.g,r.m,r.l,y,I.a],styles:[""]}),e})();var k=t("3Pt+");function j(e,o){1&e&&(n.Rb(0,"div"),n.Cc(1,"Voucher Code is required"),n.Qb())}function E(e,o){if(1&e&&(n.Rb(0,"div",18),n.Ac(1,j,2,0,"div",19),n.Qb()),2&e){const e=n.fc();n.zb(1),n.lc("ngIf",e.f.voucherCode.errors.required)}}function V(e,o){1&e&&(n.Rb(0,"div"),n.Cc(1,"Voucher Amount is required"),n.Qb())}function T(e,o){if(1&e&&(n.Rb(0,"div",18),n.Ac(1,V,2,0,"div",19),n.Qb()),2&e){const e=n.fc();n.zb(1),n.lc("ngIf",e.f.voucherAmount.errors.required)}}function F(e,o){1&e&&(n.Rb(0,"div"),n.Cc(1,"Voucher Cart Amount is required"),n.Qb())}function M(e,o){if(1&e&&(n.Rb(0,"div",18),n.Ac(1,F,2,0,"div",19),n.Qb()),2&e){const e=n.fc();n.zb(1),n.lc("ngIf",e.f.voucherCartAmount.errors.required)}}function O(e,o){1&e&&(n.Rb(0,"div"),n.Cc(1,"Voucher Type is required"),n.Qb())}function q(e,o){if(1&e&&(n.Rb(0,"div",18),n.Ac(1,O,2,0,"div",19),n.Qb()),2&e){const e=n.fc();n.zb(1),n.lc("ngIf",e.f.voucherType.errors.required)}}function D(e,o){1&e&&(n.Rb(0,"div"),n.Cc(1,"Description is required"),n.Qb())}function P(e,o){if(1&e&&(n.Rb(0,"div",18),n.Ac(1,D,2,0,"div",19),n.Qb()),2&e){const e=n.fc();n.zb(1),n.lc("ngIf",e.f.description.errors.required)}}function $(e,o){1&e&&(n.Rb(0,"div"),n.Cc(1,"Expiry Date is required"),n.Qb())}function L(e,o){if(1&e&&(n.Rb(0,"div",18),n.Ac(1,$,2,0,"div",19),n.Qb()),2&e){const e=n.fc();n.zb(1),n.lc("ngIf",e.f.expirydatetime.errors.required)}}const U=function(e){return{"is-invalid":e}},B=[{path:"",component:N},{path:":couponId/edit",component:(()=>{class e{constructor(e,o,t,r){this.formBuilder=e,this.couponService=o,this.activatedRoute=t,this.router=r,this.addCouponForm=this.formBuilder.group({voucherCode:["",k.s.required],voucherAmount:["",k.s.required],expirydatetime:[""],voucherCartAmount:["",k.s.required],voucherType:["",k.s.required],description:["",k.s.required],status:[""]})}get f(){return this.addCouponForm.controls}ngOnInit(){this.couponId=+this.activatedRoute.snapshot.params.couponId,0!==this.couponId&&this.couponService.fetchCouponDetails(this.couponId).subscribe(e=>{const o=e.coupon;console.log(o),this.addCouponForm.get("voucherCode").setValue(o.voucher_code),this.addCouponForm.get("voucherAmount").setValue(o.voucher_amount),this.addCouponForm.get("expirydatetime").setValue(o.expiry_datetime),this.addCouponForm.get("voucherCartAmount").setValue(o.voucher_cart_amount),this.addCouponForm.get("voucherType").setValue(o.voucher_type),this.addCouponForm.get("description").setValue(o.description),this.addCouponForm.get("status").setValue(o.status)})}onSubmit(){this.submitted=!0,this.addCouponForm.invalid||(""==this.couponId?this.couponService.addNewCoupon(this.addCouponForm.value).subscribe(e=>{console.log(e),"200"==e.status&&this.router.navigate(["coupon"]),"400"==e.status&&alert("Banner Not Added . Internal Server Error")},e=>{this.errorMessage=e}):this.couponService.editCoupon(this.addCouponForm.value,this.couponId).subscribe(e=>{console.log(e),"200"==e.status&&this.router.navigate(["coupon"]),"400"==e.status&&alert("Banner Not Added . Internal Server Error")},e=>{this.errorMessage=e}))}}return e.\u0275fac=function(o){return new(o||e)(n.Mb(k.c),n.Mb(d),n.Mb(c.a),n.Mb(c.f))},e.\u0275cmp=n.Gb({type:e,selectors:[["app-coupon-edit"]],decls:50,vars:25,consts:[[1,"jumbotron"],[1,"container"],[1,"row"],[1,"col-md-6","offset-md-3"],[3,"formGroup","ngSubmit"],[1,"form-group"],["type","text","formControlName","voucherCode",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","text","formControlName","voucherAmount",1,"form-control",3,"ngClass"],["type","text","formControlName","voucherCartAmount",1,"form-control",3,"ngClass"],["type","text","formControlName","voucherType",1,"form-control",3,"ngClass"],["formControlName","description","row","10","cols","10",1,"form-control",3,"ngClass"],["type","text","formControlName","expirydatetime",1,"form-control",3,"ngClass"],["for",""],["formControlName","status",1,"form-control"],["value","1"],["value","0"],[1,"btn","btn-primary"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(e,o){1&e&&(n.Rb(0,"div",0),n.Rb(1,"div",1),n.Rb(2,"div",2),n.Rb(3,"div",3),n.Rb(4,"h2"),n.Cc(5,"Add New Coupon"),n.Qb(),n.Rb(6,"form",4),n.dc("ngSubmit",(function(){return o.onSubmit()})),n.Rb(7,"div",5),n.Rb(8,"label"),n.Cc(9,"Voucher Code"),n.Qb(),n.Nb(10,"input",6),n.Ac(11,E,2,1,"div",7),n.Qb(),n.Rb(12,"div",5),n.Rb(13,"label"),n.Cc(14,"Voucher Amount"),n.Qb(),n.Nb(15,"input",8),n.Ac(16,T,2,1,"div",7),n.Qb(),n.Rb(17,"div",5),n.Rb(18,"label"),n.Cc(19,"Voucher Cart Amount"),n.Qb(),n.Nb(20,"input",9),n.Ac(21,M,2,1,"div",7),n.Qb(),n.Rb(22,"div",5),n.Rb(23,"label"),n.Cc(24,"Voucher Type"),n.Qb(),n.Nb(25,"input",10),n.Ac(26,q,2,1,"div",7),n.Qb(),n.Rb(27,"div",5),n.Rb(28,"label"),n.Cc(29,"Description"),n.Qb(),n.Rb(30,"textarea",11),n.Cc(31,"\n                "),n.Qb(),n.Ac(32,P,2,1,"div",7),n.Qb(),n.Rb(33,"div",5),n.Rb(34,"label"),n.Cc(35,"Expiry Date"),n.Qb(),n.Nb(36,"input",12),n.Ac(37,L,2,1,"div",7),n.Qb(),n.Rb(38,"div",5),n.Rb(39,"label",13),n.Cc(40,"Status"),n.Qb(),n.Rb(41,"div"),n.Rb(42,"select",14),n.Rb(43,"option",15),n.Cc(44,"Enabled"),n.Qb(),n.Rb(45,"option",16),n.Cc(46,"Disabled"),n.Qb(),n.Qb(),n.Qb(),n.Qb(),n.Rb(47,"div",5),n.Rb(48,"button",17),n.Cc(49,"Save"),n.Qb(),n.Qb(),n.Qb(),n.Qb(),n.Qb(),n.Qb(),n.Qb()),2&e&&(n.zb(6),n.lc("formGroup",o.addCouponForm),n.zb(4),n.lc("ngClass",n.pc(13,U,o.submitted&&o.f.voucherCode.errors)),n.zb(1),n.lc("ngIf",o.submitted&&o.f.voucherCode.errors),n.zb(4),n.lc("ngClass",n.pc(15,U,o.submitted&&o.f.voucherAmount.errors)),n.zb(1),n.lc("ngIf",o.submitted&&o.f.voucherAmount.errors),n.zb(4),n.lc("ngClass",n.pc(17,U,o.submitted&&o.f.voucherCartAmount.errors)),n.zb(1),n.lc("ngIf",o.submitted&&o.f.voucherCartAmount.errors),n.zb(4),n.lc("ngClass",n.pc(19,U,o.submitted&&o.f.voucherType.errors)),n.zb(1),n.lc("ngIf",o.submitted&&o.f.voucherType.errors),n.zb(4),n.lc("ngClass",n.pc(21,U,o.submitted&&o.f.description.errors)),n.zb(2),n.lc("ngIf",o.submitted&&o.f.description.errors),n.zb(4),n.lc("ngClass",n.pc(23,U,o.submitted&&o.f.expirydatetime.errors)),n.zb(1),n.lc("ngIf",o.submitted&&o.f.expirydatetime.errors))},directives:[k.u,k.l,k.e,k.b,k.k,k.d,r.k,r.m,k.r,k.o,k.t],styles:[""]}),e})()}];let J=(()=>{class e{}return e.\u0275mod=n.Kb({type:e}),e.\u0275inj=n.Jb({factory:function(o){return new(o||e)},imports:[[c.j.forChild(B)],c.j]}),e})();var G=t("PCNd");let H=(()=>{class e{}return e.\u0275mod=n.Kb({type:e}),e.\u0275inj=n.Jb({factory:function(o){return new(o||e)},imports:[[r.b,J,k.p,G.a]]}),e})()}}]);