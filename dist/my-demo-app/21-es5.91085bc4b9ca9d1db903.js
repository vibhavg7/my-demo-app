function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,n,e){return n&&_defineProperties(t.prototype,n),e&&_defineProperties(t,e),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"la9/":function(t,n,e){"use strict";e.r(n),e.d(n,"SubscriptionsModule",(function(){return E}));var i,c=e("ofXK"),o=e("tyNb"),s=e("R5w1"),r=e("vkgz"),u=e("/uUt"),l=e("Kj3r"),b=e("eIep"),a=e("fXoL"),p=e("3Pt+"),f=e("0AqG"),d=e("z6cu"),h=e("lJxs"),g=e("JIr8"),C=e("tk/3"),m=((i=function(){function t(n){_classCallCheck(this,t),this.httpClient=n,this.subscriptionServiceUrl="https://api.grostep.com/v2/customerapi/"}return _createClass(t,[{key:"fetchAllSubscriptons",value:function(t,n,e){var i={};return i.pageNumber=t,i.pageSize=n,i.filterBy=e,console.log(i),this.httpClient.post(this.subscriptionServiceUrl+"subscriptioninfo",i).pipe(Object(r.a)((function(t){})),Object(h.a)((function(t){return t})),Object(g.a)(this.handleError))}},{key:"handleError",value:function(t){var n=new s.a;return n.errorNumber=100,n.errorMessage="Server returned code: ".concat(t.status,", error message is: ").concat(t.message),n.friendlyMessage="An error retriving data",Object(d.a)(n)}}]),t}()).\u0275fac=function(t){return new(t||i)(a.ec(C.b))},i.\u0275prov=a.Mb({token:i,factory:i.\u0275fac,providedIn:"root"}),i),v=["app-subscription-data",""],I=function(t){return["/customer",t]};function k(t,n){if(1&t&&(a.Wb(0,"a",4),a.Lc(1),a.Vb()),2&t){var e=a.mc();a.tc("routerLink",a.xc(2,I,null==e.subscriptionInfo?null:e.subscriptionInfo.customer_id)),a.Cb(1),a.Nc(" ",null==e.subscriptionInfo?null:e.subscriptionInfo.customer_id," ")}}var _,y=function(t,n){return{"text-success":t,"text-danger":n}},S=((_=function(){function t(){_classCallCheck(this,t),this.checkIfAllSelected=new a.o}return _createClass(t,[{key:"ngOnInit",value:function(){console.log(this.subscriptionInfo)}},{key:"checkIfAllSelect",value:function(t){console.log(t),this.checkIfAllSelected.emit(t)}}]),t}()).\u0275fac=function(t){return new(t||_)},_.\u0275cmp=a.Kb({type:_,selectors:[["","app-subscription-data",""]],inputs:{subscriptionInfo:"subscriptionInfo"},outputs:{checkIfAllSelected:"checkIfAllSelected"},attrs:v,decls:20,vars:20,consts:[["type","checkbox",3,"value","ngModel","ngModelChange","change"],["target","_blank",3,"routerLink",4,"ngIf"],[2,"width","50px"],[2,"font-weight","bold",3,"ngClass"],["target","_blank",3,"routerLink"]],template:function(t,n){1&t&&(a.Wb(0,"td"),a.Wb(1,"input",0),a.ic("ngModelChange",(function(t){return n.subscriptionInfo.selected=t}))("change",(function(){return n.checkIfAllSelect(null==n.subscriptionInfo?null:n.subscriptionInfo.customer_id)})),a.Vb(),a.Vb(),a.Wb(2,"td"),a.Lc(3),a.Vb(),a.Wb(4,"td"),a.Jc(5,k,2,4,"a",1),a.Vb(),a.Wb(6,"td",2),a.Lc(7),a.Vb(),a.Wb(8,"td"),a.Lc(9),a.Vb(),a.Wb(10,"td",3),a.Lc(11),a.Vb(),a.Wb(12,"td"),a.Lc(13),a.Vb(),a.Wb(14,"td"),a.Lc(15),a.nc(16,"date"),a.Vb(),a.Wb(17,"td"),a.Lc(18),a.nc(19,"date"),a.Vb()),2&t&&(a.Cb(1),a.uc("value",null==n.subscriptionInfo?null:n.subscriptionInfo.customer_id),a.tc("ngModel",n.subscriptionInfo.selected),a.Cb(2),a.Nc(" ",null==n.subscriptionInfo?null:n.subscriptionInfo.user_subscribed_id,"\n"),a.Cb(2),a.tc("ngIf",null==n.subscriptionInfo?null:n.subscriptionInfo.customer_id),a.Cb(2),a.Nc(" ",null==n.subscriptionInfo?null:n.subscriptionInfo.customer_phone," "),a.Cb(2),a.Nc(" ",null==n.subscriptionInfo?null:n.subscriptionInfo.customer_name,"\n"),a.Cb(1),a.tc("ngClass",a.yc(17,y,1===(null==n.subscriptionInfo?null:n.subscriptionInfo.subscribed),0===(null==n.subscriptionInfo?null:n.subscriptionInfo.subscribed))),a.Cb(1),a.Nc(" ",1===(null==n.subscriptionInfo?null:n.subscriptionInfo.subscribed)?"Subscribed":"Not Subscribed","\n"),a.Cb(2),a.Nc(" ",1===(null==n.subscriptionInfo?null:n.subscriptionInfo.channel)?"Web":"Others","\n"),a.Cb(2),a.Nc(" ",a.pc(16,11,null==n.subscriptionInfo?null:n.subscriptionInfo.added_date,"medium"),"\n"),a.Cb(3),a.Nc(" ",a.pc(19,14,null==n.subscriptionInfo?null:n.subscriptionInfo.registered_date,"medium"),"\n"))},directives:[p.a,p.m,p.p,c.n,c.l,o.i],pipes:[c.e],styles:['td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{font-size:14px}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:45px;height:20px;margin:20px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none;background-color:#ccc}.slider[_ngcontent-%COMP%]{cursor:pointer;top:0;bottom:0;background-color:#ccc}.slider[_ngcontent-%COMP%], .slider[_ngcontent-%COMP%]:before{position:absolute;left:0;right:0;transition:.4s}.slider[_ngcontent-%COMP%]:before{content:"";height:26px;width:26px;bottom:-3px;background-color:#2196f3}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translateX(20px)}.slider.round[_ngcontent-%COMP%]{border-radius:20px}.slider.round[_ngcontent-%COMP%]:before{border-radius:50%}']}),_),W=e("Exvd");function V(t,n){if(1&t){var e=a.Xb();a.Wb(0,"tr",20),a.ic("checkIfAllSelected",(function(t){return a.Dc(e),a.mc(2).checkIfAllSelected(t)})),a.Vb()}2&t&&a.tc("subscriptionInfo",n.$implicit)}function O(t,n){if(1&t){var e=a.Xb();a.Wb(0,"table",16),a.Wb(1,"thead"),a.Wb(2,"tr"),a.Wb(3,"th"),a.Wb(4,"input",17),a.ic("change",(function(){return a.Dc(e),a.mc().selectAll()})),a.Vb(),a.Vb(),a.Wb(5,"th",18),a.Lc(6,"Id"),a.Vb(),a.Wb(7,"th"),a.Lc(8,"Customer Id"),a.Vb(),a.Wb(9,"th"),a.Lc(10,"Phone"),a.Vb(),a.Wb(11,"th"),a.Lc(12,"Name"),a.Vb(),a.Wb(13,"th"),a.Lc(14,"Subscribed"),a.Vb(),a.Wb(15,"th"),a.Lc(16,"Channel"),a.Vb(),a.Wb(17,"th"),a.Lc(18,"Added Date"),a.Vb(),a.Wb(19,"th"),a.Lc(20,"Registration Date"),a.Vb(),a.Vb(),a.Vb(),a.Wb(21,"tbody"),a.Jc(22,V,1,1,"tr",19),a.Vb(),a.Vb()}if(2&t){var i=a.mc();a.Cb(4),a.tc("checked",i.selectedAll),a.Cb(18),a.tc("ngForOf",i.subscriptions)}}function w(t,n){if(1&t){var e=a.Xb();a.Wb(0,"app-pagination",21),a.ic("currentPage",(function(t){return a.Dc(e),a.mc().currentPageFn(t)})),a.Vb()}if(2&t){var i=a.mc();a.tc("totalItemCount",i.subscriptiontotalcount)}}function P(t,n){1&t&&(a.Wb(0,"div"),a.Lc(1," No Subscription Data Found "),a.Vb())}function L(t,n){if(1&t&&(a.Wb(0,"div",22),a.Lc(1),a.Vb()),2&t){var e=a.mc();a.Cb(1),a.Nc(" Error: ",e.errorMessage,"\n")}}var M,A,N,x,j=function(){return["/subscriptions/",0,"edit"]},B=((M=function(){function t(n,e,i,c,o){_classCallCheck(this,t),this.activatedRoute=n,this.formBuilder=e,this.customerService=i,this.router=c,this.subscriptionService=o,this.disableButton=!0,this.filterBy="",this.pageTitle="Subscription Dashboard",this.currentPage=1,this.pageSize=20,this.searchCriteriaForm=this.formBuilder.group({searchCriteria:[""]})}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this.activatedRoute.snapshot.data.resolvedSubscriptions;t instanceof s.a?this.errorMessage=t.errorMessage:(this.subscriptiontotalcount=t.subscriptions_count[0].subscriptions_count,this.subscriptions=t.subscriptions_info,console.log(this.subscriptiontotalcount),console.log(this.subscriptions))}},{key:"onChanges",value:function(){var t=this;this.searchCriteriaForm.get("searchCriteria").valueChanges.pipe(Object(r.a)((function(t){})),Object(u.a)(),Object(l.a)(200),Object(b.a)((function(n){return t.filterBy=n,t.subscriptionService.fetchAllSubscriptons(t.currentPage,t.pageSize,n)}))).subscribe((function(n){console.log(n),t.subscriptiontotalcount=n.subscriptions_count[0].subscriptions_count,t.subscriptions=n.subscriptions_info}))}},{key:"currentPageFn",value:function(t){var n=this;console.log(t),this.subscriptionService.fetchAllSubscriptons(t,this.pageSize,this.filterBy).subscribe((function(t){n.subscriptiontotalcount=t.subscriptions_count[0].subscriptions_count,n.subscriptions=t.subscriptions_info}))}},{key:"selectAll",value:function(){this.selectedAll=!this.selectedAll;for(var t=0,n=0;n<this.subscriptions.length;n++)this.subscriptions[n].selected=this.selectedAll,this.subscriptions[n].selected&&t++;this.disableButton=!(t>0),console.log(t),console.log(this.subscriptions)}},{key:"checkIfAllSelected",value:function(t){for(var n=0,e=0;e<this.subscriptions.length;e++)this.subscriptions[e].selected&&n++;return this.selectedAll=n===this.subscriptions.length,this.disableButton=!(n>0),console.log(this.subscriptions),console.log(n),!0}},{key:"sendNotification",value:function(t){var n=[];this.subscriptions.forEach((function(t){!0===t.selected&&n.push(t.customer_id)})),this.customerIds=n,console.log(n),this.customerService.customerNotificationIds=this.customerIds,this.router.navigate(["subscriptions/notification/add/"+t])}}]),t}()).\u0275fac=function(t){return new(t||M)(a.Qb(o.a),a.Qb(p.d),a.Qb(f.a),a.Qb(o.f),a.Qb(m))},M.\u0275cmp=a.Kb({type:M,selectors:[["app-subscription-dashboard"]],decls:20,vars:9,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-md-2"],[1,"col-md-4"],[3,"formGroup"],["formControlName","searchCriteria","type","text","id","keyword","placeholder","Search By Phone Number","autocomplete","off","autofocus","",1,"form-control",3,"keyup"],[1,"col-md-6"],["type","button",1,"btn","btn-outline-secondary",2,"float","right","font-size","14px",3,"routerLink"],[1,"btn","btn-outline-secondary",2,"float","right",3,"disabled","click"],[1,"table-responsive"],["style","width:1200px !important","class","table",4,"ngIf"],[3,"totalItemCount","currentPage",4,"ngIf"],[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"table",2,"width","1200px !important"],["type","checkbox",3,"checked","change"],[2,"width","90px !important"],["app-subscription-data","",3,"subscriptionInfo","checkIfAllSelected",4,"ngFor","ngForOf"],["app-subscription-data","",3,"subscriptionInfo","checkIfAllSelected"],[3,"totalItemCount","currentPage"],[1,"alert","alert-danger"]],template:function(t,n){1&t&&(a.Wb(0,"div",0),a.Wb(1,"div",1),a.Lc(2),a.Vb(),a.Wb(3,"div",2),a.Wb(4,"div",3),a.Wb(5,"div",4),a.Lc(6,"Filter by:"),a.Vb(),a.Wb(7,"div",5),a.Wb(8,"form",6),a.Wb(9,"input",7),a.ic("keyup",(function(){return n.onChanges()})),a.Vb(),a.Vb(),a.Vb(),a.Wb(10,"div",8),a.Wb(11,"a",9),a.Lc(12," Add New Subscriber "),a.Vb(),a.Wb(13,"button",10),a.ic("click",(function(){return n.sendNotification(2)})),a.Lc(14," Send SMS "),a.Vb(),a.Vb(),a.Vb(),a.Wb(15,"div",11),a.Jc(16,O,23,2,"table",12),a.Jc(17,w,1,1,"app-pagination",13),a.Jc(18,P,2,0,"div",14),a.Vb(),a.Vb(),a.Vb(),a.Jc(19,L,2,1,"div",15)),2&t&&(a.Cb(2),a.Nc(" ",n.pageTitle," "),a.Cb(6),a.tc("formGroup",n.searchCriteriaForm),a.Cb(3),a.tc("routerLink",a.wc(8,j)),a.Cb(2),a.tc("disabled",n.disableButton),a.Cb(3),a.tc("ngIf",n.subscriptiontotalcount),a.Cb(1),a.tc("ngIf",n.subscriptiontotalcount),a.Cb(1),a.tc("ngIf",0==n.subscriptiontotalcount),a.Cb(1),a.tc("ngIf",n.errorMessage))},directives:[p.w,p.n,p.f,p.c,p.m,p.e,o.i,c.n,c.m,S,W.a],styles:["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{font-size:14px}"]}),M),z=e("LRne"),F=[{path:"",component:B,resolve:{resolvedSubscriptions:(A=function(){function t(n){_classCallCheck(this,t),this.subscriptionService=n,this.pagenumber=1,this.pagesize=20,this.filterBy=""}return _createClass(t,[{key:"resolve",value:function(t,n){return this.subscriptionService.fetchAllSubscriptons(this.pagenumber,this.pagesize,this.filterBy).pipe(Object(g.a)((function(t){return Object(z.a)(t)})))}}]),t}(),A.\u0275fac=function(t){return new(t||A)(a.ec(m))},A.\u0275prov=a.Mb({token:A,factory:A.\u0275fac,providedIn:"root"}),A)}},{path:"notification/add/:notificationType",component:e("+h6G").a}],J=((N=function t(){_classCallCheck(this,t)}).\u0275mod=a.Ob({type:N}),N.\u0275inj=a.Nb({factory:function(t){return new(t||N)},imports:[[o.j.forChild(F)],o.j]}),N),D=e("PCNd"),E=((x=function t(){_classCallCheck(this,t)}).\u0275mod=a.Ob({type:x}),x.\u0275inj=a.Nb({factory:function(t){return new(t||x)},imports:[[c.c,J,p.r,D.a]]}),x)}}]);