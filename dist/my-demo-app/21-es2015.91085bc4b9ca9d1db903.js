(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"la9/":function(t,n,e){"use strict";e.r(n),e.d(n,"SubscriptionsModule",(function(){return j}));var s=e("ofXK"),i=e("tyNb"),c=e("R5w1"),o=e("vkgz"),r=e("/uUt"),u=e("Kj3r"),b=e("eIep"),l=e("fXoL"),a=e("3Pt+"),p=e("0AqG"),d=e("z6cu"),f=e("lJxs"),h=e("JIr8"),g=e("tk/3");let m=(()=>{class t{constructor(t){this.httpClient=t,this.subscriptionServiceUrl="https://api.grostep.com/v2/customerapi/"}fetchAllSubscriptons(t,n,e){const s={};return s.pageNumber=t,s.pageSize=n,s.filterBy=e,console.log(s),this.httpClient.post(this.subscriptionServiceUrl+"subscriptioninfo",s).pipe(Object(o.a)(t=>{}),Object(f.a)(t=>t),Object(h.a)(this.handleError))}handleError(t){const n=new c.a;return n.errorNumber=100,n.errorMessage=`Server returned code: ${t.status}, error message is: ${t.message}`,n.friendlyMessage="An error retriving data",Object(d.a)(n)}}return t.\u0275fac=function(n){return new(n||t)(l.ec(g.b))},t.\u0275prov=l.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const I=["app-subscription-data",""],C=function(t){return["/customer",t]};function v(t,n){if(1&t&&(l.Wb(0,"a",4),l.Lc(1),l.Vb()),2&t){const t=l.mc();l.tc("routerLink",l.xc(2,C,null==t.subscriptionInfo?null:t.subscriptionInfo.customer_id)),l.Cb(1),l.Nc(" ",null==t.subscriptionInfo?null:t.subscriptionInfo.customer_id," ")}}const S=function(t,n){return{"text-success":t,"text-danger":n}};let W=(()=>{class t{constructor(){this.checkIfAllSelected=new l.o}ngOnInit(){console.log(this.subscriptionInfo)}checkIfAllSelect(t){console.log(t),this.checkIfAllSelected.emit(t)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=l.Kb({type:t,selectors:[["","app-subscription-data",""]],inputs:{subscriptionInfo:"subscriptionInfo"},outputs:{checkIfAllSelected:"checkIfAllSelected"},attrs:I,decls:20,vars:20,consts:[["type","checkbox",3,"value","ngModel","ngModelChange","change"],["target","_blank",3,"routerLink",4,"ngIf"],[2,"width","50px"],[2,"font-weight","bold",3,"ngClass"],["target","_blank",3,"routerLink"]],template:function(t,n){1&t&&(l.Wb(0,"td"),l.Wb(1,"input",0),l.ic("ngModelChange",(function(t){return n.subscriptionInfo.selected=t}))("change",(function(){return n.checkIfAllSelect(null==n.subscriptionInfo?null:n.subscriptionInfo.customer_id)})),l.Vb(),l.Vb(),l.Wb(2,"td"),l.Lc(3),l.Vb(),l.Wb(4,"td"),l.Jc(5,v,2,4,"a",1),l.Vb(),l.Wb(6,"td",2),l.Lc(7),l.Vb(),l.Wb(8,"td"),l.Lc(9),l.Vb(),l.Wb(10,"td",3),l.Lc(11),l.Vb(),l.Wb(12,"td"),l.Lc(13),l.Vb(),l.Wb(14,"td"),l.Lc(15),l.nc(16,"date"),l.Vb(),l.Wb(17,"td"),l.Lc(18),l.nc(19,"date"),l.Vb()),2&t&&(l.Cb(1),l.uc("value",null==n.subscriptionInfo?null:n.subscriptionInfo.customer_id),l.tc("ngModel",n.subscriptionInfo.selected),l.Cb(2),l.Nc(" ",null==n.subscriptionInfo?null:n.subscriptionInfo.user_subscribed_id,"\n"),l.Cb(2),l.tc("ngIf",null==n.subscriptionInfo?null:n.subscriptionInfo.customer_id),l.Cb(2),l.Nc(" ",null==n.subscriptionInfo?null:n.subscriptionInfo.customer_phone," "),l.Cb(2),l.Nc(" ",null==n.subscriptionInfo?null:n.subscriptionInfo.customer_name,"\n"),l.Cb(1),l.tc("ngClass",l.yc(17,S,1===(null==n.subscriptionInfo?null:n.subscriptionInfo.subscribed),0===(null==n.subscriptionInfo?null:n.subscriptionInfo.subscribed))),l.Cb(1),l.Nc(" ",1===(null==n.subscriptionInfo?null:n.subscriptionInfo.subscribed)?"Subscribed":"Not Subscribed","\n"),l.Cb(2),l.Nc(" ",1===(null==n.subscriptionInfo?null:n.subscriptionInfo.channel)?"Web":"Others","\n"),l.Cb(2),l.Nc(" ",l.pc(16,11,null==n.subscriptionInfo?null:n.subscriptionInfo.added_date,"medium"),"\n"),l.Cb(3),l.Nc(" ",l.pc(19,14,null==n.subscriptionInfo?null:n.subscriptionInfo.registered_date,"medium"),"\n"))},directives:[a.a,a.m,a.p,s.n,s.l,i.i],pipes:[s.e],styles:['td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{font-size:14px}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:45px;height:20px;margin:20px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none;background-color:#ccc}.slider[_ngcontent-%COMP%]{cursor:pointer;top:0;bottom:0;background-color:#ccc}.slider[_ngcontent-%COMP%], .slider[_ngcontent-%COMP%]:before{position:absolute;left:0;right:0;transition:.4s}.slider[_ngcontent-%COMP%]:before{content:"";height:26px;width:26px;bottom:-3px;background-color:#2196f3}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translateX(20px)}.slider.round[_ngcontent-%COMP%]{border-radius:20px}.slider.round[_ngcontent-%COMP%]:before{border-radius:50%}']}),t})();var V=e("Exvd");function k(t,n){if(1&t){const t=l.Xb();l.Wb(0,"tr",20),l.ic("checkIfAllSelected",(function(n){return l.Dc(t),l.mc(2).checkIfAllSelected(n)})),l.Vb()}2&t&&l.tc("subscriptionInfo",n.$implicit)}function _(t,n){if(1&t){const t=l.Xb();l.Wb(0,"table",16),l.Wb(1,"thead"),l.Wb(2,"tr"),l.Wb(3,"th"),l.Wb(4,"input",17),l.ic("change",(function(){return l.Dc(t),l.mc().selectAll()})),l.Vb(),l.Vb(),l.Wb(5,"th",18),l.Lc(6,"Id"),l.Vb(),l.Wb(7,"th"),l.Lc(8,"Customer Id"),l.Vb(),l.Wb(9,"th"),l.Lc(10,"Phone"),l.Vb(),l.Wb(11,"th"),l.Lc(12,"Name"),l.Vb(),l.Wb(13,"th"),l.Lc(14,"Subscribed"),l.Vb(),l.Wb(15,"th"),l.Lc(16,"Channel"),l.Vb(),l.Wb(17,"th"),l.Lc(18,"Added Date"),l.Vb(),l.Wb(19,"th"),l.Lc(20,"Registration Date"),l.Vb(),l.Vb(),l.Vb(),l.Wb(21,"tbody"),l.Jc(22,k,1,1,"tr",19),l.Vb(),l.Vb()}if(2&t){const t=l.mc();l.Cb(4),l.tc("checked",t.selectedAll),l.Cb(18),l.tc("ngForOf",t.subscriptions)}}function y(t,n){if(1&t){const t=l.Xb();l.Wb(0,"app-pagination",21),l.ic("currentPage",(function(n){return l.Dc(t),l.mc().currentPageFn(n)})),l.Vb()}if(2&t){const t=l.mc();l.tc("totalItemCount",t.subscriptiontotalcount)}}function O(t,n){1&t&&(l.Wb(0,"div"),l.Lc(1," No Subscription Data Found "),l.Vb())}function w(t,n){if(1&t&&(l.Wb(0,"div",22),l.Lc(1),l.Vb()),2&t){const t=l.mc();l.Cb(1),l.Nc(" Error: ",t.errorMessage,"\n")}}const L=function(){return["/subscriptions/",0,"edit"]};let M=(()=>{class t{constructor(t,n,e,s,i){this.activatedRoute=t,this.formBuilder=n,this.customerService=e,this.router=s,this.subscriptionService=i,this.disableButton=!0,this.filterBy="",this.pageTitle="Subscription Dashboard",this.currentPage=1,this.pageSize=20,this.searchCriteriaForm=this.formBuilder.group({searchCriteria:[""]})}ngOnInit(){const t=this.activatedRoute.snapshot.data.resolvedSubscriptions;t instanceof c.a?this.errorMessage=t.errorMessage:(this.subscriptiontotalcount=t.subscriptions_count[0].subscriptions_count,this.subscriptions=t.subscriptions_info,console.log(this.subscriptiontotalcount),console.log(this.subscriptions))}onChanges(){this.searchCriteriaForm.get("searchCriteria").valueChanges.pipe(Object(o.a)(t=>{}),Object(r.a)(),Object(u.a)(200),Object(b.a)(t=>(this.filterBy=t,this.subscriptionService.fetchAllSubscriptons(this.currentPage,this.pageSize,t)))).subscribe(t=>{console.log(t),this.subscriptiontotalcount=t.subscriptions_count[0].subscriptions_count,this.subscriptions=t.subscriptions_info})}currentPageFn(t){console.log(t),this.subscriptionService.fetchAllSubscriptons(t,this.pageSize,this.filterBy).subscribe(t=>{this.subscriptiontotalcount=t.subscriptions_count[0].subscriptions_count,this.subscriptions=t.subscriptions_info})}selectAll(){this.selectedAll=!this.selectedAll;let t=0;for(let n=0;n<this.subscriptions.length;n++)this.subscriptions[n].selected=this.selectedAll,this.subscriptions[n].selected&&t++;this.disableButton=!(t>0),console.log(t),console.log(this.subscriptions)}checkIfAllSelected(t){let n=0;for(let e=0;e<this.subscriptions.length;e++)this.subscriptions[e].selected&&n++;return this.selectedAll=n===this.subscriptions.length,this.disableButton=!(n>0),console.log(this.subscriptions),console.log(n),!0}sendNotification(t){const n=[];this.subscriptions.forEach(t=>{!0===t.selected&&n.push(t.customer_id)}),this.customerIds=n,console.log(n),this.customerService.customerNotificationIds=this.customerIds,this.router.navigate(["subscriptions/notification/add/"+t])}}return t.\u0275fac=function(n){return new(n||t)(l.Qb(i.a),l.Qb(a.d),l.Qb(p.a),l.Qb(i.f),l.Qb(m))},t.\u0275cmp=l.Kb({type:t,selectors:[["app-subscription-dashboard"]],decls:20,vars:9,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-md-2"],[1,"col-md-4"],[3,"formGroup"],["formControlName","searchCriteria","type","text","id","keyword","placeholder","Search By Phone Number","autocomplete","off","autofocus","",1,"form-control",3,"keyup"],[1,"col-md-6"],["type","button",1,"btn","btn-outline-secondary",2,"float","right","font-size","14px",3,"routerLink"],[1,"btn","btn-outline-secondary",2,"float","right",3,"disabled","click"],[1,"table-responsive"],["style","width:1200px !important","class","table",4,"ngIf"],[3,"totalItemCount","currentPage",4,"ngIf"],[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"table",2,"width","1200px !important"],["type","checkbox",3,"checked","change"],[2,"width","90px !important"],["app-subscription-data","",3,"subscriptionInfo","checkIfAllSelected",4,"ngFor","ngForOf"],["app-subscription-data","",3,"subscriptionInfo","checkIfAllSelected"],[3,"totalItemCount","currentPage"],[1,"alert","alert-danger"]],template:function(t,n){1&t&&(l.Wb(0,"div",0),l.Wb(1,"div",1),l.Lc(2),l.Vb(),l.Wb(3,"div",2),l.Wb(4,"div",3),l.Wb(5,"div",4),l.Lc(6,"Filter by:"),l.Vb(),l.Wb(7,"div",5),l.Wb(8,"form",6),l.Wb(9,"input",7),l.ic("keyup",(function(){return n.onChanges()})),l.Vb(),l.Vb(),l.Vb(),l.Wb(10,"div",8),l.Wb(11,"a",9),l.Lc(12," Add New Subscriber "),l.Vb(),l.Wb(13,"button",10),l.ic("click",(function(){return n.sendNotification(2)})),l.Lc(14," Send SMS "),l.Vb(),l.Vb(),l.Vb(),l.Wb(15,"div",11),l.Jc(16,_,23,2,"table",12),l.Jc(17,y,1,1,"app-pagination",13),l.Jc(18,O,2,0,"div",14),l.Vb(),l.Vb(),l.Vb(),l.Jc(19,w,2,1,"div",15)),2&t&&(l.Cb(2),l.Nc(" ",n.pageTitle," "),l.Cb(6),l.tc("formGroup",n.searchCriteriaForm),l.Cb(3),l.tc("routerLink",l.wc(8,L)),l.Cb(2),l.tc("disabled",n.disableButton),l.Cb(3),l.tc("ngIf",n.subscriptiontotalcount),l.Cb(1),l.tc("ngIf",n.subscriptiontotalcount),l.Cb(1),l.tc("ngIf",0==n.subscriptiontotalcount),l.Cb(1),l.tc("ngIf",n.errorMessage))},directives:[a.w,a.n,a.f,a.c,a.m,a.e,i.i,s.n,s.m,W,V.a],styles:["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{font-size:14px}"]}),t})();var A=e("LRne");const P=[{path:"",component:M,resolve:{resolvedSubscriptions:(()=>{class t{constructor(t){this.subscriptionService=t,this.pagenumber=1,this.pagesize=20,this.filterBy=""}resolve(t,n){return this.subscriptionService.fetchAllSubscriptons(this.pagenumber,this.pagesize,this.filterBy).pipe(Object(h.a)(t=>Object(A.a)(t)))}}return t.\u0275fac=function(n){return new(n||t)(l.ec(m))},t.\u0275prov=l.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}},{path:"notification/add/:notificationType",component:e("+h6G").a}];let N=(()=>{class t{}return t.\u0275mod=l.Ob({type:t}),t.\u0275inj=l.Nb({factory:function(n){return new(n||t)},imports:[[i.j.forChild(P)],i.j]}),t})();var x=e("PCNd");let j=(()=>{class t{}return t.\u0275mod=l.Ob({type:t}),t.\u0275inj=l.Nb({factory:function(n){return new(n||t)},imports:[[s.c,N,a.r,x.a]]}),t})()}}]);