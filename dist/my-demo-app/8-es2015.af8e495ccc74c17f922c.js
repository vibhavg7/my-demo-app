(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"0AqG":function(t,e,s){"use strict";s.d(e,"a",(function(){return b}));var o=s("LRne"),n=s("z6cu"),r=s("tk/3"),c=s("vkgz"),i=s("lJxs"),u=s("JIr8"),l=s("fXoL");let b=(()=>{class t{constructor(t){this.http=t,this.customerCarts=[],this.customerServiceUrl="https://api.grostep.com/v2/customerapi/"}get customerNotificationIds(){return this.customerIds}set customerNotificationIds(t){this.customerIds=t}fetchAllCustomers(t,e,s){const o={};return o.page_number=t,o.page_size=e,o.filterBy=s,this.http.post(this.customerServiceUrl+"customerinfo",o).pipe(Object(c.a)(t=>{}),Object(i.a)(t=>t),Object(u.a)(this.handleError))}fetchAllCustomerOrders(t,e,s,o){const n={};return n.page_number=e,n.page_size=s,n.customerId=t,n.filterBy=o,console.log(n),this.http.post(this.customerServiceUrl+"customerinfo/customerorders",n).pipe(Object(c.a)(t=>{this.customerOrders=t.customer_orders_info,console.log(this.customerOrders)}),Object(i.a)(t=>t),Object(u.a)(this.handleError))}fetchOrderProducts(t){if(this.customerOrders.length>0){console.log("inside");const e=this.customerOrders.filter(e=>+e.order_id==+t);return Object(o.a)(e[0])}return this.http.get(`${this.customerServiceUrl}customerinfo/customerorderproducts/${t}`).pipe(Object(c.a)(t=>{}),Object(i.a)(t=>t),Object(u.a)(this.handleError))}fetchCustomerInfoById(t){return this.customerData?Object(o.a)(this.customerData):this.http.get(`${this.customerServiceUrl}customerinfo/${t}`).pipe(Object(c.a)(t=>{this.customerData=t}),Object(i.a)(t=>t),Object(u.a)(this.handleError))}registerCustomer(t){const e={};e.customerName=t.customerName,e.customerPhone=t.customerPhone,e.customerDOB=t.customerDOB,e.status=t.status;const s=this.customerServiceUrl+"registerCustomerFromAdminPanel",o=new r.e({"Content-Type":"application/json"});return this.http.post(s,e,{headers:o}).pipe(Object(c.a)(t=>{}),Object(i.a)(t=>t),Object(u.a)(t=>this.handleError(t)))}editCustomer(t,e){const s={};return s.customer_name=t.customerName,s.customer_dob=t.customerDOB,s.phone=t.customerPhone,s.status=t.status,s.email=t.customerEmail,console.log(s),this.http.put(`${this.customerServiceUrl}/updateCustomerFromAdminPanel/${e}`,s).pipe(Object(c.a)(t=>{}),Object(i.a)(t=>t),Object(u.a)(this.handleError))}sendNotification(t,e){const s={};return s.notificationType=+t,s.customerIds=this.customerNotificationIds,s.messageTitle=e.messageTitle,s.messageBody=e.messageBody,console.log(s),this.http.post(this.customerServiceUrl+"/sendUserNotificationFromAdminPanel",s).pipe(Object(c.a)(t=>{console.log(t)}),Object(i.a)(t=>t),Object(u.a)(this.handleError))}handleError(t){let e="";return e=t.error instanceof ErrorEvent?"An error occurred: "+t.error.message:`Server returned code: ${t.status}, error message is: ${t.message}`,Object(n.a)(e)}}return t.\u0275fac=function(e){return new(e||t)(l.ec(r.b))},t.\u0275prov=l.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},R5w1:function(t,e,s){"use strict";s.d(e,"a",(function(){return o}));class o{}},"la9/":function(t,e,s){"use strict";s.r(e),s.d(e,"SubscriptionsModule",(function(){return x}));var o=s("ofXK"),n=s("tyNb"),r=s("R5w1"),c=s("vkgz"),i=s("/uUt"),u=s("Kj3r"),l=s("eIep"),b=s("fXoL"),a=s("3Pt+"),p=s("0AqG"),d=s("z6cu"),h=s("lJxs"),f=s("JIr8"),m=s("tk/3");let g=(()=>{class t{constructor(t){this.httpClient=t,this.subscriptionServiceUrl="https://api.grostep.com/v2/customerapi/"}fetchAllSubscriptons(t,e,s){const o={};return o.pageNumber=t,o.pageSize=e,o.filterBy=s,console.log(o),this.httpClient.post(this.subscriptionServiceUrl+"subscriptioninfo",o).pipe(Object(c.a)(t=>{}),Object(h.a)(t=>t),Object(f.a)(this.handleError))}handleError(t){const e=new r.a;return e.errorNumber=100,e.errorMessage=`Server returned code: ${t.status}, error message is: ${t.message}`,e.friendlyMessage="An error retriving data",Object(d.a)(e)}}return t.\u0275fac=function(e){return new(e||t)(b.ec(m.b))},t.\u0275prov=b.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const I=["app-subscription-data",""],C=function(t){return["/customer",t]};function v(t,e){if(1&t&&(b.Wb(0,"a",4),b.Lc(1),b.Vb()),2&t){const t=b.mc();b.tc("routerLink",b.xc(2,C,null==t.subscriptionInfo?null:t.subscriptionInfo.customer_id)),b.Cb(1),b.Nc(" ",null==t.subscriptionInfo?null:t.subscriptionInfo.customer_id," ")}}const O=function(t,e){return{"text-success":t,"text-danger":e}};let S=(()=>{class t{constructor(){this.checkIfAllSelected=new b.o}ngOnInit(){console.log(this.subscriptionInfo)}checkIfAllSelect(t){console.log(t),this.checkIfAllSelected.emit(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=b.Kb({type:t,selectors:[["","app-subscription-data",""]],inputs:{subscriptionInfo:"subscriptionInfo"},outputs:{checkIfAllSelected:"checkIfAllSelected"},attrs:I,decls:20,vars:20,consts:[["type","checkbox",3,"value","ngModel","ngModelChange","change"],["target","_blank",3,"routerLink",4,"ngIf"],[2,"width","50px"],[2,"font-weight","bold",3,"ngClass"],["target","_blank",3,"routerLink"]],template:function(t,e){1&t&&(b.Wb(0,"td"),b.Wb(1,"input",0),b.ic("ngModelChange",(function(t){return e.subscriptionInfo.selected=t}))("change",(function(){return e.checkIfAllSelect(null==e.subscriptionInfo?null:e.subscriptionInfo.customer_id)})),b.Vb(),b.Vb(),b.Wb(2,"td"),b.Lc(3),b.Vb(),b.Wb(4,"td"),b.Jc(5,v,2,4,"a",1),b.Vb(),b.Wb(6,"td",2),b.Lc(7),b.Vb(),b.Wb(8,"td"),b.Lc(9),b.Vb(),b.Wb(10,"td",3),b.Lc(11),b.Vb(),b.Wb(12,"td"),b.Lc(13),b.Vb(),b.Wb(14,"td"),b.Lc(15),b.nc(16,"date"),b.Vb(),b.Wb(17,"td"),b.Lc(18),b.nc(19,"date"),b.Vb()),2&t&&(b.Cb(1),b.uc("value",null==e.subscriptionInfo?null:e.subscriptionInfo.customer_id),b.tc("ngModel",e.subscriptionInfo.selected),b.Cb(2),b.Nc(" ",null==e.subscriptionInfo?null:e.subscriptionInfo.user_subscribed_id,"\n"),b.Cb(2),b.tc("ngIf",null==e.subscriptionInfo?null:e.subscriptionInfo.customer_id),b.Cb(2),b.Nc(" ",null==e.subscriptionInfo?null:e.subscriptionInfo.customer_phone," "),b.Cb(2),b.Nc(" ",null==e.subscriptionInfo?null:e.subscriptionInfo.customer_name,"\n"),b.Cb(1),b.tc("ngClass",b.yc(17,O,1===(null==e.subscriptionInfo?null:e.subscriptionInfo.subscribed),0===(null==e.subscriptionInfo?null:e.subscriptionInfo.subscribed))),b.Cb(1),b.Nc(" ",1===(null==e.subscriptionInfo?null:e.subscriptionInfo.subscribed)?"Subscribed":"Not Subscribed","\n"),b.Cb(2),b.Nc(" ",1===(null==e.subscriptionInfo?null:e.subscriptionInfo.channel)?"Web":"Others","\n"),b.Cb(2),b.Nc(" ",b.pc(16,11,null==e.subscriptionInfo?null:e.subscriptionInfo.added_date,"medium"),"\n"),b.Cb(3),b.Nc(" ",b.pc(19,14,null==e.subscriptionInfo?null:e.subscriptionInfo.registered_date,"medium"),"\n"))},directives:[a.a,a.m,a.p,o.n,o.l,n.i],pipes:[o.e],styles:['td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{font-size:14px}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:45px;height:20px;margin:20px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none;background-color:#ccc}.slider[_ngcontent-%COMP%]{cursor:pointer;top:0;bottom:0;background-color:#ccc}.slider[_ngcontent-%COMP%], .slider[_ngcontent-%COMP%]:before{position:absolute;left:0;right:0;transition:.4s}.slider[_ngcontent-%COMP%]:before{content:"";height:26px;width:26px;bottom:-3px;background-color:#2196f3}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translateX(20px)}.slider.round[_ngcontent-%COMP%]{border-radius:20px}.slider.round[_ngcontent-%COMP%]:before{border-radius:50%}']}),t})();var _=s("Exvd");function y(t,e){if(1&t){const t=b.Xb();b.Wb(0,"tr",20),b.ic("checkIfAllSelected",(function(e){return b.Dc(t),b.mc(2).checkIfAllSelected(e)})),b.Vb()}2&t&&b.tc("subscriptionInfo",e.$implicit)}function W(t,e){if(1&t){const t=b.Xb();b.Wb(0,"table",16),b.Wb(1,"thead"),b.Wb(2,"tr"),b.Wb(3,"th"),b.Wb(4,"input",17),b.ic("change",(function(){return b.Dc(t),b.mc().selectAll()})),b.Vb(),b.Vb(),b.Wb(5,"th",18),b.Lc(6,"Id"),b.Vb(),b.Wb(7,"th"),b.Lc(8,"Customer Id"),b.Vb(),b.Wb(9,"th"),b.Lc(10,"Phone"),b.Vb(),b.Wb(11,"th"),b.Lc(12,"Name"),b.Vb(),b.Wb(13,"th"),b.Lc(14,"Subscribed"),b.Vb(),b.Wb(15,"th"),b.Lc(16,"Channel"),b.Vb(),b.Wb(17,"th"),b.Lc(18,"Added Date"),b.Vb(),b.Wb(19,"th"),b.Lc(20,"Registration Date"),b.Vb(),b.Vb(),b.Vb(),b.Wb(21,"tbody"),b.Jc(22,y,1,1,"tr",19),b.Vb(),b.Vb()}if(2&t){const t=b.mc();b.Cb(4),b.tc("checked",t.selectedAll),b.Cb(18),b.tc("ngForOf",t.subscriptions)}}function k(t,e){if(1&t){const t=b.Xb();b.Wb(0,"app-pagination",21),b.ic("currentPage",(function(e){return b.Dc(t),b.mc().currentPageFn(e)})),b.Vb()}if(2&t){const t=b.mc();b.tc("totalItemCount",t.subscriptiontotalcount)}}function V(t,e){1&t&&(b.Wb(0,"div"),b.Lc(1," No Subscription Data Found "),b.Vb())}function j(t,e){if(1&t&&(b.Wb(0,"div",22),b.Lc(1),b.Vb()),2&t){const t=b.mc();b.Cb(1),b.Nc(" Error: ",t.errorMessage,"\n")}}const A=function(){return["/subscriptions/",0,"edit"]};let N=(()=>{class t{constructor(t,e,s,o,n){this.activatedRoute=t,this.formBuilder=e,this.customerService=s,this.router=o,this.subscriptionService=n,this.disableButton=!0,this.filterBy="",this.pageTitle="Subscription Dashboard",this.currentPage=1,this.pageSize=20,this.searchCriteriaForm=this.formBuilder.group({searchCriteria:[""]})}ngOnInit(){const t=this.activatedRoute.snapshot.data.resolvedSubscriptions;t instanceof r.a?this.errorMessage=t.errorMessage:(this.subscriptiontotalcount=t.subscriptions_count[0].subscriptions_count,this.subscriptions=t.subscriptions_info,console.log(this.subscriptiontotalcount),console.log(this.subscriptions))}onChanges(){this.searchCriteriaForm.get("searchCriteria").valueChanges.pipe(Object(c.a)(t=>{}),Object(i.a)(),Object(u.a)(200),Object(l.a)(t=>(this.filterBy=t,this.subscriptionService.fetchAllSubscriptons(this.currentPage,this.pageSize,t)))).subscribe(t=>{console.log(t),this.subscriptiontotalcount=t.subscriptions_count[0].subscriptions_count,this.subscriptions=t.subscriptions_info})}currentPageFn(t){console.log(t),this.subscriptionService.fetchAllSubscriptons(t,this.pageSize,this.filterBy).subscribe(t=>{this.subscriptiontotalcount=t.subscriptions_count[0].subscriptions_count,this.subscriptions=t.subscriptions_info})}selectAll(){this.selectedAll=!this.selectedAll;let t=0;for(let e=0;e<this.subscriptions.length;e++)this.subscriptions[e].selected=this.selectedAll,this.subscriptions[e].selected&&t++;this.disableButton=!(t>0),console.log(t),console.log(this.subscriptions)}checkIfAllSelected(t){let e=0;for(let s=0;s<this.subscriptions.length;s++)this.subscriptions[s].selected&&e++;return this.selectedAll=e===this.subscriptions.length,this.disableButton=!(e>0),console.log(this.subscriptions),console.log(e),!0}sendNotification(t){const e=[];this.subscriptions.forEach(t=>{!0===t.selected&&e.push(t.customer_id)}),this.customerIds=e,console.log(e),this.customerService.customerNotificationIds=this.customerIds,this.router.navigate(["subscriptions/notification/add/"+t])}}return t.\u0275fac=function(e){return new(e||t)(b.Qb(n.a),b.Qb(a.d),b.Qb(p.a),b.Qb(n.f),b.Qb(g))},t.\u0275cmp=b.Kb({type:t,selectors:[["app-subscription-dashboard"]],decls:20,vars:9,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row"],[1,"col-md-2"],[1,"col-md-4"],[3,"formGroup"],["formControlName","searchCriteria","type","text","id","keyword","placeholder","Search By Phone Number","autocomplete","off","autofocus","",1,"form-control",3,"keyup"],[1,"col-md-6"],["type","button",1,"btn","btn-outline-secondary",2,"float","right","font-size","14px",3,"routerLink"],[1,"btn","btn-outline-secondary",2,"float","right",3,"disabled","click"],[1,"table-responsive"],["style","width:1200px !important","class","table",4,"ngIf"],[3,"totalItemCount","currentPage",4,"ngIf"],[4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"table",2,"width","1200px !important"],["type","checkbox",3,"checked","change"],[2,"width","90px !important"],["app-subscription-data","",3,"subscriptionInfo","checkIfAllSelected",4,"ngFor","ngForOf"],["app-subscription-data","",3,"subscriptionInfo","checkIfAllSelected"],[3,"totalItemCount","currentPage"],[1,"alert","alert-danger"]],template:function(t,e){1&t&&(b.Wb(0,"div",0),b.Wb(1,"div",1),b.Lc(2),b.Vb(),b.Wb(3,"div",2),b.Wb(4,"div",3),b.Wb(5,"div",4),b.Lc(6,"Filter by:"),b.Vb(),b.Wb(7,"div",5),b.Wb(8,"form",6),b.Wb(9,"input",7),b.ic("keyup",(function(){return e.onChanges()})),b.Vb(),b.Vb(),b.Vb(),b.Wb(10,"div",8),b.Wb(11,"a",9),b.Lc(12," Add New Subscriber "),b.Vb(),b.Wb(13,"button",10),b.ic("click",(function(){return e.sendNotification(2)})),b.Lc(14," Send SMS "),b.Vb(),b.Vb(),b.Vb(),b.Wb(15,"div",11),b.Jc(16,W,23,2,"table",12),b.Jc(17,k,1,1,"app-pagination",13),b.Jc(18,V,2,0,"div",14),b.Vb(),b.Vb(),b.Vb(),b.Jc(19,j,2,1,"div",15)),2&t&&(b.Cb(2),b.Nc(" ",e.pageTitle," "),b.Cb(6),b.tc("formGroup",e.searchCriteriaForm),b.Cb(3),b.tc("routerLink",b.wc(8,A)),b.Cb(2),b.tc("disabled",e.disableButton),b.Cb(3),b.tc("ngIf",e.subscriptiontotalcount),b.Cb(1),b.tc("ngIf",e.subscriptiontotalcount),b.Cb(1),b.tc("ngIf",0==e.subscriptiontotalcount),b.Cb(1),b.tc("ngIf",e.errorMessage))},directives:[a.w,a.n,a.f,a.c,a.m,a.e,n.i,o.n,o.m,S,_.a],styles:["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{font-size:14px}"]}),t})();var P=s("LRne");const w=[{path:"",component:N,resolve:{resolvedSubscriptions:(()=>{class t{constructor(t){this.subscriptionService=t,this.pagenumber=1,this.pagesize=20,this.filterBy=""}resolve(t,e){return this.subscriptionService.fetchAllSubscriptons(this.pagenumber,this.pagesize,this.filterBy).pipe(Object(f.a)(t=>Object(P.a)(t)))}}return t.\u0275fac=function(e){return new(e||t)(b.ec(g))},t.\u0275prov=b.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}},{path:"notification/add/:notificationType",component:s("+h6G").a}];let L=(()=>{class t{}return t.\u0275mod=b.Ob({type:t}),t.\u0275inj=b.Nb({factory:function(e){return new(e||t)},imports:[[n.j.forChild(w)],n.j]}),t})();var M=s("PCNd");let x=(()=>{class t{}return t.\u0275mod=b.Ob({type:t}),t.\u0275inj=b.Nb({factory:function(e){return new(e||t)},imports:[[o.c,L,a.r,M.a]]}),t})()}}]);